generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

enum Role {
  MAHASISWA
  DOSEN
  ADMIN
}

model User {
  id        String   @id @default(uuid())
  name      String
  email     String   @unique
  password  String
  role      Role     @default(MAHASISWA)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  skripsis  Skripsi[]      @relation("MahasiswaSkripsi")
  bimbingan Skripsi[]      @relation("DosenPembimbing")
}

model Skripsi {
  id           String   @id @default(uuid())
  title        String
  status       String   @default("Draft")
  mahasiswaId  String
  pembimbingId String

  bab1         String?
  bab2         String?
  bab3         String?
  bab4         String?
  bab5         String?

  mahasiswa    User     @relation("MahasiswaSkripsi", fields: [mahasiswaId], references: [id])
  pembimbing   User     @relation("DosenPembimbing", fields: [pembimbingId], references: [id])

  bimbingan    LogBimbingan[]
  penilaian    Penilaian?

  createdAt    DateTime @default(now())
  updatedAt    DateTime @updatedAt
}

model LogBimbingan {
  id         String   @id @default(uuid())
  skripsiId  String
  isi        String
  status     String
  komentar   String
  createdAt  DateTime @default(now())

  skripsi    Skripsi  @relation(fields: [skripsiId], references: [id])
}

model Penilaian {
  id         String   @id @default(uuid())
  skripsiId  String   @unique
  nilai      Float
  komentar   String?
  createdAt  DateTime @default(now())

  skripsi    Skripsi  @relation(fields: [skripsiId], references: [id])
}
